---
description: Toda vez que for citado "domain", "dom√≠nio" do projeto, voc√™ deve incluir essa regra.
globs:
alwaysApply: false
---

# üìå PRD: Funcionalidade de Objetivos Pessoais com Refinamento por Chatbot

## Vis√£o Geral

A funcionalidade de **Objetivos Pessoais** permite que os usu√°rios enviem descri√ß√µes simples de objetivos e metas pessoais que s√£o automaticamente refinadas por um chatbot especializado em desenvolvimento pessoal e coaching. O objetivo √© elevar a descri√ß√£o ao n√≠vel de um coach experiente, fornecendo uma sa√≠da estruturada e acion√°vel para o crescimento pessoal.

Esse recurso utiliza a **API da OpenAI** para refinar objetivos por meio de um modelo de linguagem (LLM) especializado em desenvolvimento pessoal.

---

## üéØ Objetivos

- Permitir que os usu√°rios enviem descri√ß√µes b√°sicas de objetivos pessoais.
- Refinar automaticamente as descri√ß√µes usando um LLM especializado em coaching.
- Retornar os objetivos refinados em formato JSON estruturado.
- Armazenar sugest√µes de refinamento e hist√≥rico de conversas.
- Suportar melhorias iterativas com base no feedback do usu√°rio.
- Permitir salvar objetivos finalizados.
- Converter objetivos em markdown, fragmentar o conte√∫do e armazenar como embeddings vetoriais para consultas futuras por chatbot.

---

## üß± Stack Tecnol√≥gica

- **Frontend:** React Router 7 (Modo Framework)
- **Banco de Dados:** SQLite
- **ORM:** Prisma ORM
- **API LLM:** OpenAI (para refinamento de objetivos pessoais)
- **Armazenamento Vetorial:** Solu√ß√£o compat√≠vel com SQLite

---

## üì• Entrada do Usu√°rio

Usu√°rios fornecem:

- Uma descri√ß√£o simples do objetivo pessoal (ex: "quero aprender ingl√™s fluente", "melhorar minha sa√∫de f√≠sica").

---

## ü§ñ Processamento pelo Chatbot

O sistema envia a descri√ß√£o do objetivo juntamente com o contexto de desenvolvimento pessoal para a **OpenAI**, instruindo o modelo a responder como um coach de vida experiente.

### Exemplo de Prompt:

```
Voc√™ √© um coach de vida experiente especializado em desenvolvimento pessoal e estabelecimento de metas.
Por favor, refine o seguinte objetivo pessoal e retorne um objeto JSON com:
t√≠tulo, descri√ß√£o, passos_de_acao, tempo_estimado, indicadores_de_progresso, habitos_sugeridos e estrategias_de_motivacao.

Objetivo original: "quero aprender ingl√™s fluente"
```

---

## üì§ Sa√≠da JSON Esperada

```json
{
  "title": "Desenvolver Flu√™ncia em Ingl√™s atrav√©s de Pr√°tica Estruturada",
  "description": "Estabelecer um plano estruturado para alcan√ßar flu√™ncia em ingl√™s atrav√©s de pr√°tica di√°ria, imers√£o cultural e uso de ferramentas variadas de aprendizado.",
  "estimated_time": "12-18 meses",
  "action_steps": [
    "Avaliar n√≠vel atual atrav√©s de teste de profici√™ncia",
    "Estabelecer rotina di√°ria de 30 minutos de estudo",
    "Inscrever-se em curso online estruturado",
    "Praticar conversa√ß√£o semanal com falantes nativos",
    "Consumir m√≠dia em ingl√™s (filmes, podcasts, livros)",
    "Fazer avalia√ß√µes mensais de progresso"
  ],
  "progress_indicators": [
    "Conseguir manter conversa√ß√£o de 10 minutos sem pausas",
    "Compreender 80% de um filme sem legendas",
    "Ler um livro completo em ingl√™s",
    "Obter pontua√ß√£o espec√≠fica em teste oficial (ex: TOEFL 100+)"
  ],
  "suggested_habits": [
    "Estudar ingl√™s 30 minutos toda manh√£",
    "Mudar idioma do celular para ingl√™s",
    "Escrever di√°rio pessoal em ingl√™s",
    "Assistir not√≠cias em ingl√™s durante caf√© da manh√£"
  ],
  "motivation_strategies": "Definir marcos mensais com recompensas, encontrar parceiro de estudos, participar de grupos de conversa√ß√£o, visualizar objetivos futuros que requerem ingl√™s (viagens, trabalho internacional)."
}
```

---

## üí¨ Hist√≥rico de Conversas

- Todas as conversas com o chatbot s√£o salvas na tabela **`chats`**.
- Cada mensagem individual √© armazenada na tabela **`chat_messages`** com roles espec√≠ficos (user, assistant, system).
- Usu√°rios podem acessar e continuar conversas anteriores atrav√©s do hist√≥rico.
- Cada conversa √© registrada com data/hora e pode estar associada a uma tarefa espec√≠fica.

---

## üìö Estrutura de Armazenamento e Banco de Dados

### Tabelas

#### `chats`

| Campo      | Tipo     | Descri√ß√£o                         |
| ---------- | -------- | --------------------------------- |
| id         | string   | UUID do chat                      |
| title      | string?  | T√≠tulo opcional da conversa       |
| created_at | datetime | Data de cria√ß√£o                   |
| updated_at | datetime | Data da √∫ltima modifica√ß√£o        |

#### `chat_messages`

| Campo         | Tipo     | Descri√ß√£o                                      |
| ------------- | -------- | ---------------------------------------------- |
| id            | string   | UUID da mensagem                               |
| content       | string   | Conte√∫do da mensagem                           |
| role          | enum     | Papel da mensagem (user, assistant, system)   |
| chat_id       | string   | Chave estrangeira para `chats`                 |
| created_at    | datetime | Data de cria√ß√£o                                |
| updated_at    | datetime | Data da √∫ltima modifica√ß√£o                     |

#### `goals` (renomeado de `tasks`)

| Campo                     | Tipo     | Descri√ß√£o                                    |
| ------------------------- | -------- | -------------------------------------------- |
| id                        | string   | UUID do objetivo                             |
| title                     | string   | T√≠tulo refinado do objetivo                  |
| description               | string   | Descri√ß√£o detalhada do objetivo              |
| action_steps              | string?  | Lista de passos de a√ß√£o a serem executados  |
| estimated_time            | string   | Tempo estimado (ex: "3 meses")               |
| motivation_strategies     | string?  | Estrat√©gias para manter motiva√ß√£o            |
| progress_indicators       | string?  | Indicadores para medir progresso             |
| suggested_habits          | string?  | H√°bitos sugeridos para alcan√ßar objetivo    |
| chat_message_id           | string?  | Chave estrangeira para `chat_messages`       |
| created_at                | datetime | Data de cria√ß√£o                              |
| updated_at                | datetime | Data da √∫ltima modifica√ß√£o                   |

### Relacionamentos

- **Chat ‚Üî ChatMessage**: Um chat pode ter m√∫ltiplas mensagens (1:N)
- **ChatMessage ‚Üî Goal**: Uma mensagem pode estar associada a um objetivo (1:1)

### Enum: ChatMessageRole

- `user`: Mensagem enviada pelo usu√°rio
- `assistant`: Resposta do chatbot/coach IA
- `system`: Mensagens de sistema ou configura√ß√£o

#### `embeddings` (Planejado para Fase Vetorial)

| Campo      | Tipo     | Descri√ß√£o                                   |
| ---------- | -------- | ------------------------------------------- |
| id         | string   | UUID do embedding                           |
| goal_id    | string   | Chave estrangeira para `goals`              |
| vector     | vector   | Representa√ß√£o vetorial para busca sem√¢ntica |
| created_at | datetime | Data de cria√ß√£o do embedding                |

---

## üß† Funcionalidade Vetorial com IA (Futuro)

- Todos os objetivos finalizados ser√£o armazenados como embeddings vetoriais.
- Um segundo chatbot poder√° futuramente responder a perguntas como:
  - "Quais objetivos envolvem desenvolvimento de habilidades?"
  - "Liste objetivos relacionados √† sa√∫de e bem-estar."
  - "Mostre estrat√©gias que funcionaram para objetivos similares."

---

## üñºÔ∏è Interface do Usu√°rio

- Interface de chatbot para envio e refinamento de objetivos pessoais.
- Exibi√ß√£o do JSON refinado de forma leg√≠vel e inspiradora.
- Bot√£o "Salvar Objetivo" para persistir a meta estruturada.
- Dashboard de acompanhamento de progresso.

---

## üìà M√©tricas de Sucesso

- Percentual de objetivos refinados mais de uma vez.
- Tempo m√©dio para definir um objetivo estruturado.
- Quantidade de objetivos com embeddings armazenados.
- Engajamento com sugest√µes e acompanhamento de progresso.
- Taxa de conclus√£o de objetivos estabelecidos.

---

## üìÖ Roteiro Proposto

| Fase          | Entregas Principais                                          |
| ------------- | ------------------------------------------------------------ |
| MVP           | Entrada de objetivos, integra√ß√£o com OpenAI, JSON, persist√™ncia |
| Itera√ß√µes     | Hist√≥rico de conversa, refinamentos, UI de coaching          |
| Fase Vetorial | Embeddings vetoriais, chatbot com busca de objetivos similares |

---

## üìù Considera√ß√µes Finais

Este recurso transforma significativamente como as pessoas definem e perseguem seus objetivos pessoais, permitindo que qualquer pessoa transforme ideias vagas em planos estruturados e acion√°veis. Atua como um coach pessoal virtual, oferecendo orienta√ß√£o profissional para o desenvolvimento pessoal com apoio de IA especializada.

